<!DOCTYPE html>
<html class="h-100">

<head>
  <title>DuckSoup | Mirror</title>
  <meta charset="utf-8">
  <link rel="shortcut icon" href="data:image/x-icon;," type="image/x-icon">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
  integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js"
  integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc"
  crossorigin="anonymous"></script>
  <link rel="stylesheet" href="../../assets/styles/test/mirror/main.css">
  <script src="../../assets/scripts/lib/ducksoup.js"></script>
  <script src="../../assets/scripts/test/mirror/app.js"></script>
</head>
<body class="d-flex flex-column h-100">
  <div class="container mt-3">
    <div class="row">
      <div class="col-4">
        <div id="live-control" class="show-when-running p-2 mb-3 bg-light" style="border: 1px solid #eee;">
          <p>Update Audio FX</p>
          <div class="row">
            <div class="col-3">
              <small>property</small>
            </div>
            <div class="col-3">
              <small>float value</small>
            </div>
            <div class="col-3">
              <small>transition</small>
            </div>
          </div>
          <form class="fx-sequence">
            <input type="hidden" name="type" value="audio_fx">
            <div class="mb-3">
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
              </div>
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
              </div>
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
              </div>
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
                <div class="col-2">
                  <button type="submit" class="btn btn-outline-secondary">Send</button>
                </div>
              </div>
            </div>
          </form>
          <p>Update Video FX</p>
          <div class="row">
            <div class="col-3">
              <small>property</small>
            </div>
            <div class="col-3">
              <small>float value</small>
            </div>
            <div class="col-3">
              <small>transition</small>
            </div>
          </div>
          <form class="fx-sequence">
            <input type="hidden" name="type" value="video_fx">
            <div class="mb-3">
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
              </div>
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
              </div>
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
              </div>
              <div class="row g-2">
                <div class="col-3">
                  <input type="text" class="form-control" name="property[]">
                </div>
                <div class="col-3">
                  <input type="text" class="form-control" name="value[]">
                </div>
                <div class="col-4">
                  <div class="input-group">
                    <input type="test" class="form-control" name="duration[]" value="">
                    <span class="input-group-text">ms</span>
                  </div>
                </div>
                <div class="col-2">
                  <button type="submit" class="btn btn-outline-secondary">Send</button>
                </div>
              </div>
            </div>
          </form>
        </div>
        <form id="settings">
          <input type="hidden" name="isMirror" value="true">
          <div class="row mb-4">
            <div class="col-9">
              <h2>Mirror</h2>
            </div>
            <div class="col-3">
              <button type="submit" class="float-end btn btn-outline-success show-when-not-running" id="start">Start</button>
              <button type="button" class="float-end btn btn-outline-secondary show-when-running" id="stop">Stop</button>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-audio-fx" class="form-label">Audio FX</label>
                <input class="form-control" id="input-audio-fx" type="text" name="audioFx" placeholder="fx_name prop1=value1 prop2=value2...">
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-video-fx" class="form-label">Video FX</label>
                <input class="form-control" id="input-video-fx" type="text" name="videoFx" value="" placeholder="fx_name prop1=value1 prop2=value2...">
              </div>
            </div>
          </div>
          <hr/>
          <div class="row">
            <div class="col-6">
              <div class="mb-3">
                <label for="input-video-format" class="form-label">Video format</label>
                <select class="form-select" id="input-video-format" name="videoFormat">
                  <option value="H264" selected>H264</option>
                  <option value="VP8">VP8</option>
                </select>
              </div>
            </div>
            <div class="col">
              <div class="mb-3" style="padding-top: 28px;">
                <input class="form-check-input" id="input-gpu" type="checkbox" value="false" name="gpu">
                <label class="form-check-label" for="input-gpu">GPU (if relevant)</label>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-6">
              <div class="mb-3">
                <label for="input-recording-mode" class="form-label">Recording mode</label>
                <select class="form-select" id="input-recording-mode" name="recordingMode">
                  <option value="muxed" selected>muxed</option>
                  <option value="split">split</option>
                  <option value="passthrough">passthrough</option>
                  <option value="none">none</option>
                </select>
              </div>
            </div>
            <div class="col">
              <div class="mb-3" style="padding-top: 28px;">
                <input class="form-check-input" id="input-overlay" type="checkbox" value="false" name="overlay">
                <label class="form-check-label" for="input-overlay">overlay (if FX)</label>
              </div>
            </div>
          </div>
          <hr/>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-audio" class="form-label">Audio input</label>
                <select class="form-select" id="input-audio" name="audioDevice"></select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-video" class="form-label">Video input</label>
                <select class="form-select" id="input-video" name="videoDevice"></select>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-frame-rate" class="form-label">Frame rate</label>
                <div class="input-group">
                  <input class="form-control" id="input-frame-rate" type="number" name="frameRate" value="30">
                  <span class="input-group-text">fps</span>
                </div>
              </div>
            </div>
            <div class="col">
              <div class="mb-4">
                <label for="input-duration" class="form-label">Duration</label>
                <div class="input-group">
                  <input class="form-control" id="input-duration" type="number" name="duration" value="30">
                  <span class="input-group-text">sec</span>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-width" class="form-label">Width</label>
                <input class="form-control" id="input-width" type="number" name="width" value="800">
              </div>
            </div>
            <div class="col">
              <div class="mb-3">
                <label for="input-height" class="form-label">Height</label>
                <input class="form-control" id="input-height" type="number" name="height" value="600">
              </div>
            </div>
            <p>Width/height may not apply depending on browser encoder and DuckSoup configuration</p>
          </div>
          <hr/>
          <div class="row">
            <div class="col">
              <div class="mb-3">
                <label for="input-signaling-url" class="form-label">DuckSoup signaling URL</label>
                <input class="form-control" id="input-signaling-url" type="text" name="signalingUrl">
              </div>
            </div>
          </div>
        </form>
      </div>
      <div class="col-8">
        <div id="stopped" class="show-when-ended">
          <p id="stopped-message"></p>
        </div>
        <div id="ducksoup-root" class="show-when-running mb-3"></div>
        <div class="row mb-3 stats">
          <div class="col-3">
            <p>video up ↑</p>
            <p><strong>bitrate:</strong> <span id="video-out-bitrate">0.0</span> kb/s</p>
            <p><strong>encoding:</strong> <span id="video-out-frameWidth">0</span>x<span id="video-out-frameHeight">0</span>@<span id="video-out-framesPerSecond">0</span>fps</p>
            <p><strong>keyframes encoded:</strong> <span id="video-out-keyFramesEncoded"></span></p>
            <p><strong>received:</strong><br/>
              PLI: <span id="video-out-pliCount">0</span>
              SLI: <span id="video-out-sliCount">0</span>
              FIR: <span id="video-out-firCount">0</span>
              NACK: <span id="video-out-nackCount">0</span> 
            </p>
            <p><strong>av. encode time:</strong> <span id="video-out-averageEncodeTime">0</span></p>
            <p><strong>qlty limitation:</strong> <span id="video-out-qualityLimitationReason">none</span></p>  
            <p><strong>frames discarded on send:</strong> <span id="video-out-framesDiscardedOnSend">0</span></p>
            <p><strong>sent packets:</strong> <span id="video-out-packetsSent">0</span></p>
          </div>
          <div class="col-3">
            <p>video down ↓</p>
            <p><strong>bitrate:</strong> <span id="video-in-bitrate">0.0</span> kb/s</p>
            <p><strong>decoding:</strong> <span id="video-in-frameWidth">0</span>x<span id="video-in-frameHeight">0</span>@<span id="video-in-framesPerSecond">0</span>fps</p>
            <p><strong>keyframes decoded:</strong> <span id="video-in-keyFramesDecoded"></span></p>
            <p><strong>sent:</strong><br/>
              PLI: <span id="video-in-pliCount">0</span>
              SLI: <span id="video-in-sliCount">0</span>
              FIR: <span id="video-in-firCount">0</span>
              NACK: <span id="video-in-nackCount">0</span> 
            </p>
            <p><strong>proc. jitter:</strong> <span id="video-in-processedJitter"></span></p>
            <p><strong>est. jitter:</strong> <span id="video-in-jitter"></span></p>
            <p><strong>packets:</strong><br/>
              rec.: <span id="video-in-packetsReceived">0</span>
              lost: <span id="video-in-packetsLost">0</span>
              disc.: <span id="video-in-packetsDiscarded">0</span>
              rep: <span id="video-in-packetsRepaired">0</span> 
            </p>
            <p><strong>frames dropped:</strong> <span id="video-in-framesDropped">0</span></p>
          </div>
          <div class="col-3">
            <p>audio up ↑</p>
            <p><strong>bitrate:</strong> <span id="audio-out-bitrate">0.0</span> kb/s</p>
            <p><strong>target bitrate:</strong> <span id="audio-out-targetBitrate">0.0</span> kb/s</p>
            <p><strong>received:</strong><br/>
              NACK: <span id="audio-out-nackCount">0</span> 
            </p>
            <p><strong>sent packets:</strong> <span id="audio-out-packetsSent">0</span></p>
          </div>
          <div class="col-3">
            <p>audio down ↓</p>
            <p><strong>bitrate:</strong> <span id="audio-in-bitrate">0.0</span> kb/s</p>
            <p><strong>concealed samples:</strong> <span id="audio-in-concealedSamples"></span></p>
            <p><strong>sent:</strong><br/>
              NACK: <span id="audio-in-nackCount">0</span> 
            </p>
            <p><strong>total duration:</strong> <span id="audio-in-totalSamplesDuration"></span></p>
            <p><strong>proc. jitter:</strong> <span id="audio-in-processedJitter">0</span></p>
            <p><strong>est. jitter:</strong> <span id="audio-in-jitter"></span></p>
            <p><strong>packets:</strong><br/>
              rec.: <span id="audio-in-packetsReceived">0</span>
              lost: <span id="audio-in-packetsLost">0</span>
              disc.: <span id="audio-in-packetsDiscarded">0</span>
              rep: <span id="audio-in-packetsRepaired">0</span> 
            </p>
          </div>
        </div>
        <hr/>
        <div class="row mb-3 stats">
          <div class="col-3">
            <p>server stats</p>
            <p><strong>est. jitter:</strong> <span id="remote-video-in-jitter"></span></p>
            <p><strong>lost:</strong><br/>
              fraction: <span id="remote-video-in-fractionLost">0</span>
              packets: <span id="remote-video-in-packetsLost">0</span>
            </p>
            <p><strong>RTT:</strong><br/>
              RTT: <span id="remote-video-in-roundTripTime">0</span>
              meas.: <span id="remote-video-in-roundTripTimeMeasurements">0</span>
              total: <span id="remote-video-in-totalRoundTripTime">0</span>
            </p>
          </div>
          <div class="col-3">
            <p>server stats</p>
            <p><strong>packets sent:</strong> <span id="remote-video-out-packetsSent"></span></p>
            <p><strong>lost:</strong><br/>
              fraction: <span id="remote-video-out-fractionLost">0</span>
              packets: <span id="remote-video-out-packetsLost">0</span>
            </p>
            <p><strong>RTT:</strong><br/>
              RTT: <span id="remote-video-out-roundTripTime">0</span>
              meas.: <span id="remote-video-out-roundTripTimeMeasurements">0</span>
              total: <span id="remote-video-out-totalRoundTripTime">0</span>
            </p>
          </div>
          <div class="col-3">
            <p>server stats</p>
            <p><strong>est. jitter:</strong> <span id="remote-audio-in-jitter"></span></p>
            <p><strong>lost:</strong><br/>
              fraction: <span id="remote-audio-in-fractionLost">0</span>
              packets: <span id="remote-audio-in-packetsLost">0</span>
            </p>
            <p><strong>RTT:</strong><br/>
              RTT: <span id="remote-audio-in-roundTripTime">0</span>
              meas.: <span id="remote-audio-in-roundTripTimeMeasurements">0</span>
              total: <span id="remote-audio-in-totalRoundTripTime">0</span>
            </p>
          </div>
          <div class="col-3">
            <p>server stats</p>
            <p><strong>packets sent:</strong> <span id="remote-audio-out-packetsSent"></span></p>

            <p><strong>lost:</strong><br/>
              fraction: <span id="remote-audio-out-fractionLost">0</span>
              packets: <span id="remote-audio-out-packetsLost">0</span>
            </p>
            <p><strong>RTT:</strong><br/>
              RTT: <span id="remote-audio-out-roundTripTime">0</span>
              meas.: <span id="remote-audio-out-roundTripTimeMeasurements">0</span>
              total: <span id="remote-audio-out-totalRoundTripTime">0</span>
            </p>
          </div>
        </div>
        <div class="video-container show-when-running">
          <video id="local-video" autoplay muted></video>
          <div class="overlay overlay-top"><div>Direct from webcam</div></div>
        </div>
      </div>
    </div>
  </div>
</body>
</html>